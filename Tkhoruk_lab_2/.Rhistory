smooth = list(col.smooth = 4, col.spread = 4))
View(carDF)
View(carDF)
View(DF)
carDF <- subset(DF, select = c(ranking, overall.score, teaching.score, research.score, citations.score, industry.income.score, intl.outlook.score, number.students, students.staff.ratio, perc.intl.students, gender.ratio))
car::scatterplotMatrix(carDF, col = 1, regLine = list(col = 2),
smooth = list(col.smooth = 4, col.spread = 4))
View(carDF)
sum(DF)
summary(DF)
DF[['gender.ratio'] == Inf]
DF[['gender.ratio'] = Inf]
count <- 1
for(i in DF$gender.ratio) {
if(i == Inf)
print(DF[count])
count <- count + 1
}
count <- 1
for(i in DF$gender.ratio) {
if(i == Inf)
print(DF['ranking'][count])
count <- count + 1
}
count <- 1
for(i in DF$gender.ratio) {
if(i == Inf)
print(count)
count <- count + 1
}
count <- 1
for(i in DF$gender.ratio) {
if(i == Inf)
DF$gender.ratio[conunt] <- 100
count <- count + 1
}
summary(DF)
count <- 1
for(i in DF$gender.ratio) {
if(i == Inf)
DF$gender.ratio[count] <- 100
count <- count + 1
}
summary(DF)
carDF <- subset(DF, select = c(ranking, overall.score, teaching.score, research.score, citations.score, industry.income.score, intl.outlook.score, number.students, students.staff.ratio, perc.intl.students, gender.ratio))
car::scatterplotMatrix(carDF, col = 1, regLine = list(col = 2),
smooth = list(col.smooth = 4, col.spread = 4))
View(DF)
View(DF)
write.csv(DF, "universities.csv", row.name = FALSE)
library(utils)
write.csv(DF, "universities.csv", row.name = FALSE)
write.csv(DF, "universities.csv")
View(DF)
summary(DF)
modUniversity <- lm(gender.ratio ~ . - title - location, data = DF)
modUniversity
modUniversity <- lm(perc.intl.students ~ . - title - location, data = DF)
modUniversity
modUniversity <- lm(perc.intl.students ~ . - title - location, data = DF)
modUniversity
car::scatterplotMatrix(carDF, col = 1, regLine = list(col = 2),
smooth = list(col.smooth = 4, col.spread = 4))
modUniversity <- lm(perc.intl.students ~ teaching.score + research.score + intl.outlook.score + citations.score + number.students, data = DF)
modUniversity
carDF <- subset(DF, select = c(teaching.score, research.score, citations.score, intl.outlook.score, number.students, perc.intl.students))
car::scatterplotMatrix(carDF, col = 1, regLine = list(col = 2),
smooth = list(col.smooth = 4, col.spread = 4))
modUniversity <- lm(perc.intl.students ~ teaching.score + research.score + intl.outlook.score + citations.score + industry.income.score, data = DF)
modUniversity
carDF <- subset(DF, select = c(teaching.score, research.score, citations.score, intl.outlook.score, industry.income.score, perc.intl.students))
car::scatterplotMatrix(carDF, col = 1, regLine = list(col = 2),
smooth = list(col.smooth = 4, col.spread = 4))
Y <- DF$perc.intl.students
X1 <- DF$teaching.score
X2 <- DF$research.score
X3 <- DF$intl.outlook.score
X4 <- DF$citations.score
X5 <- DF$number.students
X <- cbind(1, X1, X2, X3, X4, X5)
Y <- leastSquares3D$yLin
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
mod <- lm(Y ~ X1 + X2 + X3 + X4 + X5)
mod$coefficients
Y <- DF$perc.intl.students
X1 <- DF$teaching.score
X2 <- DF$research.score
X3 <- DF$intl.outlook.score
X4 <- DF$citations.score
X5 <- DF$number.students
X <- cbind(1, X1, X2, X3, X4, X5)
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
mod <- lm(Y ~ X1 + X2 + X3 + X4 + X5)
mod$coefficients
Y <- DF$perc.intl.students
X1 <- DF$teaching.score
X2 <- DF$research.score
X3 <- DF$intl.outlook.score
X4 <- DF$citations.score
X5 <- DF$industry.income.score
X <- cbind(1, X1, X2, X3, X4, X5)
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
mod <- lm(Y ~ X1 + X2 + X3 + X4 + X5)
mod$coefficients
View(beta)
solve(t(X) %*% X) %*% t(X) %*% Y
t(X)
X
Y <- DF$perc.intl.students
X1 <- DF$teaching.score
X2 <- DF$research.score
X3 <- DF$intl.outlook.score
X4 <- DF$citations.score
X5 <- DF$industry.income.score
X <- cbind(1, X1, X2, X3, X4, X5)
X
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
mod <- lm(Y ~ X1 + X2 + X3 + X4 + X5)
mod$coefficients
Y <- DF$perc.intl.students
X1 <- DF$teaching.score
X2 <- DF$research.score
X3 <- DF$intl.outlook.score
X4 <- DF$citations.score
X5 <- DF$industry.income.score
X <- cbind(1, X1, X2, X3, X4, X5)
X
beta <- solve(t(X) %% X) %% t(X) %*% Y
beta
mod <- lm(Y ~ X1 + X2 + X3 + X4 + X5)
mod$coefficients
Y <- DF$perc.intl.students
X1 <- DF$teaching.score
X2 <- DF$research.score
X3 <- DF$intl.outlook.score
X4 <- DF$citations.score
X5 <- DF$industry.income.score
X <- cbind(1, X1, X2, X3, X4, X5)
X
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
mod <- lm(Y ~ X1 + X2 + X3 + X4 + X5)
mod$coefficients
Y <- DF$perc.intl.students
X1 <- DF$teaching.score
X2 <- DF$research.score
X3 <- DF$intl.outlook.score
X4 <- DF$citations.score
X5 <- DF$industry.income.score
X <- cbind(1, X1, X2, X3, X4, X5)
X
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
mod <- lm(Y ~ X1 + X2 + X3 + X4 + X5)
mod$coefficients
Y <- DF$perc.intl.students
X1 <- DF$teaching.score
X2 <- DF$research.score
X3 <- DF$intl.outlook.score
X4 <- DF$citations.score
X5 <- DF$industry.income.score
X <- cbind(1, X1, X2, X3, X4, X5)
X
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
mod <- lm(Y ~ X1 + X2 + X3 + X4 + X5)
mod$coefficients
Y
Y <- DF$perc.intl.students
X1 <- DF$teaching.score
X2 <- DF$research.score
X3 <- DF$intl.outlook.score
X4 <- DF$citations.score
X5 <- DF$industry.income.score
X <- cbind(1, X1, X2, X3, X4, X5)
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
mod <- lm(Y ~ X1 + X2 + X3 + X4 + X5)
mod$coefficients
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
Y <- DF$perc.intl.students
X1 <- DF$teaching.score
X2 <- DF$research.score
X3 <- DF$intl.outlook.score
X4 <- DF$citations.score
X5 <- DF$industry.income.score
X <- cbind(1, X1, X2, X3, X4)
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
X <- cbind(1, X1, X2, X3)
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
X <- cbind(1, X1, X2)
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
X <- cbind(1, X2)
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
Y <- DF$overall.score
X1 <- DF$teaching.score
X2 <- DF$research.score
X3 <- DF$intl.outlook.score
X4 <- DF$citations.score
X5 <- DF$industry.income.score
X <- cbind(1, X1, X2, X3, X4, X5)
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
Y <- DF$perc.intl.students
X1 <- DF$teaching.score
X2 <- DF$research.score
X3 <- DF$intl.outlook.score
X4 <- DF$citations.score
X5 <- DF$industry.income.score
X <- cbind(1, X1, X2, X3, X4, X5)
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
summary(Y)
is.na(Y)
sum(is.na(Y))
DF <- DF %>%
mutate(perc.intl.students=replace(perc.intl.students,is.na(perc.intl.students),median(perc.intl.students,na.rm = TRUE)))
DF <- DF %>%
mutate(perc.intl.students=replace(perc.intl.students,is.na(perc.intl.students),median(perc.intl.students,na.rm = TRUE)))
sum(is.na(DF$perc.intl.students))
DF <- DF %>%
mutate(perc.intl.students=replace(perc.intl.students,is.na(perc.intl.students),median(perc.intl.students,na.rm = TRUE)))
DF <- DF %>%
mutate(gender.ratio=replace(gender.ratio,is.na(gender.ratio),median(gender.ratio,na.rm = TRUE)))
library(lubridate)
library(data.table)
library(dplyr)
library(utils)
DF <- DF %>%
mutate(perc.intl.students=replace(perc.intl.students,is.na(perc.intl.students),median(perc.intl.students,na.rm = TRUE)))
sum(is.na(DF$perc.intl.students))
Y <- DF$perc.intl.students
X1 <- DF$teaching.score
X2 <- DF$research.score
X3 <- DF$intl.outlook.score
X4 <- DF$citations.score
X5 <- DF$industry.income.score
X <- cbind(1, X1, X2, X3, X4, X5)
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
mod <- lm(Y ~ X1 + X2 + X3 + X4 + X5)
mod$coefficients
sum(is.na(DF$overall.score))
sum(is.na(DF$number.students))
carDF <- subset(DF, select = c(teaching.score, research.score, citations.score, intl.outlook.score, industry.income.score, perc.intl.students))
car::scatterplotMatrix(carDF, col = 1, regLine = list(col = 2),
smooth = list(col.smooth = 4, col.spread = 4))
summary(mod)
carDF <- subset(DF, select = c(teaching.score, research.score, citations.score, intl.outlook.score, number.students, perc.intl.students))
carDF <- subset(DF, select = c(teaching.score, research.score, citations.score, intl.outlook.score, number.students, perc.intl.students))
car::scatterplotMatrix(carDF, col = 1, regLine = list(col = 2),
smooth = list(col.smooth = 4, col.spread = 4))
mod <- lm(Y ~ X1 + X2 + X3 + X4 + X5)
mod$coefficients
Y <- DF$perc.intl.students
X1 <- DF$teaching.score
X2 <- DF$research.score
X3 <- DF$intl.outlook.score
X4 <- DF$citations.score
X5 <- DF$students.staff.ratio
X <- cbind(1, X1, X2, X3, X4, X5)
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
mod <- lm(Y ~ X1 + X2 + X3 + X4 + X5)
mod$coefficients
summary(mod)
Y <- DF$perc.intl.students
X1 <- DF$teaching.score
X2 <- DF$research.score
X3 <- DF$intl.outlook.score
X4 <- DF$citations.score
X5 <- DF$gender.ratio
X <- cbind(1, X1, X2, X3, X4, X5)
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
mod <- lm(Y ~ X1 + X2 + X3 + X4 + X5)
mod$coefficients
summary(mod)
Y <- DF$perc.intl.students
X1 <- DF$teaching.score
X2 <- DF$research.score
X3 <- DF$intl.outlook.score
X4 <- DF$citations.score
X5 <- DF$students.staff.ratio
X <- cbind(1, X1, X2, X3, X4, X5)
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
mod <- lm(Y ~ X1 + X2 + X3 + X4 + X5)
mod$coefficients
summary(mod)
carDF <- subset(DF, select = c(teaching.score, research.score, citations.score, intl.outlook.score, students.staff.ratio, perc.intl.students))
car::scatterplotMatrix(carDF, col = 1, regLine = list(col = 2),
smooth = list(col.smooth = 4, col.spread = 4))
Y <- DF$perc.intl.students
X1 <- DF$teaching.score
X2 <- DF$research.score
X3 <- DF$intl.outlook.score
X4 <- DF$citations.score
X5 <- DF$students.staff.ratio
X <- cbind(1, X1, X2, X3, X4, X5)
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
mod <- lm(Y ~ X1 + X2 + X3 + X4 + X5)
mod$coefficients
summary(mod)
mod$fitted.values
lm(Y ~ X1)
lm(Y ~ X2)
lm(Y ~ X3)
lm(Y ~ X4)
lm(Y ~ X5)
summary(lm(Y ~ X1))
summary(lm(Y ~ X2))
summary(lm(Y ~ X3))
summary(lm(Y ~ X4))
summary(lm(Y ~ X5))
summary(lm(Y ~ X3)) #Найкраща
View(X)
sum <- summary(lm(Y ~ X3)) #Найкраща
sum$r.squared
summary(lm(Y ~ X4))$r.squared
max(summary(lm(Y ~ X1))$r.squared, summary(lm(Y ~ X2))$r.squared, summary(lm(Y ~ X3))$r.squared, summary(lm(Y ~ X4))$r.squared, summary(lm(Y ~ X5)$r.squared))
summary(lm(Y ~ X1))$r.squared, summary(lm(Y ~ X2))$r.squared, summary(lm(Y ~ X3))$r.squared, summary(lm(Y ~ X4))$r.squared, summary(lm(Y ~ X5)$r.squared))
rsq <- c(summary(lm(Y ~ X1))$r.squared, summary(lm(Y ~ X2))$r.squared, summary(lm(Y ~ X3))$r.squared, summary(lm(Y ~ X4))$r.squared, summary(lm(Y ~ X5))$r.squared)
rsq
max(rsq)
mod$residuals
summary(mod$residuals)
summary(mod$fitted.values)
UR <- read.csv("universities_ranking.csv")
US <- read.csv("universities_scores.csv")
DF <- cbind(US, UR[c("number.students", "students.staff.ratio", "perc.intl.students", "gender.ratio")])
#Чистим overall.score
count <- 1
for(i in DF$overall.score) {
DF$overall.score[count] <- as.character(mean(as.numeric(unlist(strsplit(i, "вЂ“")))))
count <- count + 1
}
DF$overall.score <- as.numeric(DF$overall.score)
#Чистим number.students
DF <- DF %>%
mutate(number.students = gsub(",", "", number.students))
DF$number.students <- as.numeric(DF$number.students)
#Чистим perc.intl.students
DF <- DF %>%
mutate(perc.intl.students = gsub("%", "", perc.intl.students))
DF$perc.intl.students <- as.numeric(DF$perc.intl.students)
DF <- DF %>%
mutate(perc.intl.students=replace(perc.intl.students,is.na(perc.intl.students),median(perc.intl.students,na.rm = TRUE)))
#Чистим gender.ratio
count <- 1
for(i in DF$gender.ratio) {
if(!is.na(i)) {
num <- as.numeric(unlist(strsplit(i, ":")))
DF$gender.ratio[count] <- as.character(num[1]/num[2])
}
count <- count + 1
}
DF$gender.ratio <- as.numeric(DF$gender.ratio)
DF <- DF %>%
mutate(gender.ratio=replace(gender.ratio,is.na(gender.ratio),median(gender.ratio,na.rm = TRUE)))
count <- 1
for(i in DF$gender.ratio) {
if(i == Inf)
DF$gender.ratio[count] <- 100
count <- count + 1
}
View(DF)
library(lubridate)
library(data.table)
library(dplyr)
library(utils)
UR <- read.csv("universities_ranking.csv")
US <- read.csv("universities_scores.csv")
DF <- cbind(US, UR[c("number.students", "students.staff.ratio", "perc.intl.students", "gender.ratio")])
#Чистим overall.score
count <- 1
for(i in DF$overall.score) {
DF$overall.score[count] <- as.character(mean(as.numeric(unlist(strsplit(i, "вЂ“")))))
count <- count + 1
}
DF$overall.score <- as.numeric(DF$overall.score)
#Чистим number.students
DF <- DF %>%
mutate(number.students = gsub(",", "", number.students))
DF$number.students <- as.numeric(DF$number.students)
#Чистим perc.intl.students
DF <- DF %>%
mutate(perc.intl.students = gsub("%", "", perc.intl.students))
DF$perc.intl.students <- as.numeric(DF$perc.intl.students)
DF <- DF %>%
mutate(perc.intl.students=replace(perc.intl.students,is.na(perc.intl.students),median(perc.intl.students,na.rm = TRUE)))
#Чистим gender.ratio
count <- 1
for(i in DF$gender.ratio) {
if(!is.na(i)) {
num <- as.numeric(unlist(strsplit(i, ":")))
DF$gender.ratio[count] <- as.character(num[1]/num[2])
}
count <- count + 1
}
DF$gender.ratio <- as.numeric(DF$gender.ratio)
DF <- DF %>%
mutate(gender.ratio=replace(gender.ratio,is.na(gender.ratio),median(gender.ratio,na.rm = TRUE)))
count <- 1
for(i in DF$gender.ratio) {
if(i == Inf)
DF$gender.ratio[count] <- 100
count <- count + 1
}
Y <- DF$perc.intl.students
X1 <- DF$teaching.score
X2 <- DF$research.score
X3 <- DF$intl.outlook.score
X4 <- DF$citations.score
X5 <- DF$students.staff.ratio
X <- cbind(1, X1, X2, X3, X4, X5)
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
mod <- lm(Y ~ X1 + X2 + X3 + X4 + X5)
mod$coefficients
rsq <- c(summary(lm(Y ~ X1))$r.squared, summary(lm(Y ~ X2))$r.squared, summary(lm(Y ~ X3))$r.squared, summary(lm(Y ~ X4))$r.squared, summary(lm(Y ~ X5))$r.squared)
max(rsq)
rsq
max(rsq)
summary(mod$fitted.values)
summary(mod$residuals)
Y_ <- mod$fitted.values
e <- mod$residuals
summary(Y_)
summary(e)
mod <- lm(Y ~ X1 + X2 + X3 + X4 + X5)
mod$coefficients
summary(mod)
library(lubridate)
library(data.table)
library(dplyr)
library(utils)
UR <- read.csv("universities_ranking.csv")
US <- read.csv("universities_scores.csv")
DF <- cbind(US, UR[c("number.students", "students.staff.ratio", "perc.intl.students", "gender.ratio")])
#Чистим overall.score
count <- 1
for(i in DF$overall.score) {
DF$overall.score[count] <- as.character(mean(as.numeric(unlist(strsplit(i, "вЂ“")))))
count <- count + 1
}
DF$overall.score <- as.numeric(DF$overall.score)
#Чистим number.students
DF <- DF %>%
mutate(number.students = gsub(",", "", number.students))
DF$number.students <- as.numeric(DF$number.students)
#Чистим perc.intl.students
DF <- DF %>%
mutate(perc.intl.students = gsub("%", "", perc.intl.students))
DF$perc.intl.students <- as.numeric(DF$perc.intl.students)
DF <- DF %>%
mutate(perc.intl.students=replace(perc.intl.students,is.na(perc.intl.students),median(perc.intl.students,na.rm = TRUE)))
#Чистим gender.ratio
count <- 1
for(i in DF$gender.ratio) {
if(!is.na(i)) {
num <- as.numeric(unlist(strsplit(i, ":")))
DF$gender.ratio[count] <- as.character(num[1]/num[2])
}
count <- count + 1
}
DF$gender.ratio <- as.numeric(DF$gender.ratio)
DF <- DF %>%
mutate(gender.ratio=replace(gender.ratio,is.na(gender.ratio),median(gender.ratio,na.rm = TRUE)))
count <- 1
for(i in DF$gender.ratio) {
if(i == Inf)
DF$gender.ratio[count] <- 100
count <- count + 1
}
#A
Y <- DF$perc.intl.students
X1 <- DF$teaching.score
X2 <- DF$research.score
X3 <- DF$intl.outlook.score
X4 <- DF$citations.score
X5 <- DF$students.staff.ratio
X <- cbind(1, X1, X2, X3, X4, X5)
beta <- solve(t(X) %*% X) %*% t(X) %*% Y
beta
mod <- lm(Y ~ X1 + X2 + X3 + X4 + X5)
mod$coefficients
summary(mod)
#B
carDF <- subset(DF, select = c(teaching.score, research.score, citations.score, intl.outlook.score, students.staff.ratio, perc.intl.students))
car::scatterplotMatrix(carDF, col = 1, regLine = list(col = 2),
smooth = list(col.smooth = 4, col.spread = 4))
#C
rsq <- c(summary(lm(Y ~ X1))$r.squared, summary(lm(Y ~ X2))$r.squared, summary(lm(Y ~ X3))$r.squared, summary(lm(Y ~ X4))$r.squared, summary(lm(Y ~ X5))$r.squared)
rsq
max(rsq)
#X3 найбільше R^2
#D
Y_ <- mod$fitted.values
e <- mod$residuals
summary(Y_)
summary(e)
